<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Detector Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .header {
      text-align: center;
      margin-bottom: 30px;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .stat-card {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 6px;
      text-align: center;
    }
    .stat-value {
      font-size: 2em;
      font-weight: bold;
      color: #2c3e50;
    }
    .stat-label {
      color: #7f8c8d;
      margin-top: 5px;
    }
    .section {
      margin: 30px 0;
    }
    .section h2 {
      border-bottom: 2px solid #3498db;
      padding-bottom: 10px;
    }
    .sample-list {
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    .sample-item {
      padding: 15px;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .sample-text {
      flex: 1;
      margin-right: 15px;
      max-width: 500px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .sample-label {
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
    }
    .label-human {
      background: #d4edda;
      color: #155724;
    }
    .label-ai {
      background: #f8d7da;
      color: #721c24;
    }
    .label-pending {
      background: #fff3cd;
      color: #856404;
    }
    button {
      background: #3498db;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #2980b9;
    }
    .export-section {
      text-align: center;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>AI Detection Dashboard</h1>
      <p>Monitor and manage your AI detection data</p>
    </div>

    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value" data-testid="total-detections">0</div>
        <div class="stat-label">Total Detections</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" data-testid="collected-samples">0</div>
        <div class="stat-label">Collected Samples</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" data-testid="accuracy-rate">0%</div>
        <div class="stat-label">Accuracy Rate</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" data-testid="processed-today">0</div>
        <div class="stat-label">Processed Today</div>
      </div>
    </div>

    <div class="section">
      <h2>Recent Detections</h2>
      <div class="sample-list" data-testid="recent-detections">
        <div class="sample-item">
          <div class="sample-text">It is important to note that this analysis requires careful consideration...</div>
          <div class="sample-label label-ai">AI (87%)</div>
        </div>
        <div class="sample-item">
          <div class="sample-text">omg just had the best coffee ever! totally recommend this place â˜•</div>
          <div class="sample-label label-human">Human (92%)</div>
        </div>
        <div class="sample-item">
          <div class="sample-text">The methodology employed in this study demonstrates rigorous standards...</div>
          <div class="sample-label label-ai">AI (91%)</div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>Training Data Collection</h2>
      <div class="sample-list" data-testid="training-samples">
        <div class="sample-item">
          <div class="sample-text">Furthermore, it should be mentioned that the implications are significant...</div>
          <div class="sample-label label-ai">Marked as AI</div>
        </div>
        <div class="sample-item">
          <div class="sample-text">lol that's so funny ðŸ˜‚ can't stop laughing</div>
          <div class="sample-label label-human">Marked as Human</div>
        </div>
        <div class="sample-item">
          <div class="sample-text">This text needs manual review for proper classification...</div>
          <div class="sample-label label-pending">Pending Review</div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>Data Export</h2>
      <div class="export-section">
        <p>Export your collected training data for analysis or model improvement</p>
        <button data-testid="export-data">Export Training Data (JSON)</button>
        <button data-testid="export-csv">Export as CSV</button>
        <button data-testid="export-analytics">Export Analytics Report</button>
      </div>
    </div>

    <div class="section">
      <h2>Settings</h2>
      <button onclick="window.open('popup.html', '_blank')">Open Settings</button>
      <button data-testid="clear-data">Clear All Data</button>
      <button data-testid="reset-stats">Reset Statistics</button>
    </div>
  </div>

  <script>
    // Simulate loading dashboard data
    function loadDashboardData() {
      // Update statistics
      document.querySelector('[data-testid="total-detections"]').textContent = '1,247';
      document.querySelector('[data-testid="collected-samples"]').textContent = '89';
      document.querySelector('[data-testid="accuracy-rate"]').textContent = '94%';
      document.querySelector('[data-testid="processed-today"]').textContent = '23';
    }

    // Export functionality
    function exportTrainingData() {
      const data = {
        version: "1.0",
        exported_at: new Date().toISOString(),
        samples: [
          {
            id: "sample_1",
            text: "Furthermore, it should be mentioned that the implications are significant...",
            label: "ai",
            manually_verified: true,
            timestamp: "2024-01-15T10:30:00Z"
          },
          {
            id: "sample_2", 
            text: "lol that's so funny ðŸ˜‚ can't stop laughing",
            label: "human",
            manually_verified: true,
            timestamp: "2024-01-15T11:45:00Z"
          },
          {
            id: "sample_3",
            text: "This text needs manual review for proper classification...",
            label: "pending",
            manually_verified: false,
            timestamp: "2024-01-15T12:15:00Z"
          }
        ],
        metadata: {
          total_samples: 89,
          ai_samples: 42,
          human_samples: 38,
          pending_samples: 9
        }
      };

      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `training-data-${Date.now()}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function exportCSV() {
      const csvContent = [
        'ID,Text,Label,Confidence,Timestamp,Manually_Verified',
        'sample_1,"Furthermore, it should be mentioned...",ai,0.91,2024-01-15T10:30:00Z,true',
        'sample_2,"lol that\'s so funny ðŸ˜‚",human,0.92,2024-01-15T11:45:00Z,true',
        'sample_3,"This text needs manual review...",pending,0.65,2024-01-15T12:15:00Z,false'
      ].join('\n');

      const blob = new Blob([csvContent], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `ai-detection-data-${Date.now()}.csv`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function exportAnalytics() {
      const report = {
        summary: {
          total_detections: 1247,
          accuracy_rate: 0.94,
          avg_confidence: 0.87,
          processing_speed: "0.23s avg"
        },
        patterns: {
          most_common_ai_indicators: ["important to note", "furthermore", "methodology"],
          most_common_human_indicators: ["lol", "omg", "emoji usage"],
          confidence_distribution: {
            "high (>0.8)": 78,
            "medium (0.5-0.8)": 15,
            "low (<0.5)": 7
          }
        },
        performance: {
          daily_detections: [12, 23, 34, 28, 45, 67, 23],
          error_rate: 0.03,
          api_response_time: "245ms avg"
        }
      };

      const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `analytics-report-${Date.now()}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    // Event listeners
    document.querySelector('[data-testid="export-data"]').addEventListener('click', exportTrainingData);
    document.querySelector('[data-testid="export-csv"]').addEventListener('click', exportCSV);
    document.querySelector('[data-testid="export-analytics"]').addEventListener('click', exportAnalytics);

    document.querySelector('[data-testid="clear-data"]').addEventListener('click', () => {
      if (confirm('Are you sure you want to clear all collected data? This cannot be undone.')) {
        alert('Data cleared successfully');
        // Reset sample counts
        document.querySelector('[data-testid="collected-samples"]').textContent = '0';
      }
    });

    document.querySelector('[data-testid="reset-stats"]').addEventListener('click', () => {
      if (confirm('Are you sure you want to reset all statistics?')) {
        document.querySelector('[data-testid="total-detections"]').textContent = '0';
        document.querySelector('[data-testid="accuracy-rate"]').textContent = '0%';
        document.querySelector('[data-testid="processed-today"]').textContent = '0';
        alert('Statistics reset successfully');
      }
    });

    // Load data on page load
    loadDashboardData();
  </script>
</body>
</html>